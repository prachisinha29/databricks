# Databricks notebook source
# MAGIC %pip install dbldatagen

# COMMAND ----------

import dbldatagen as dg

dbfs_path = "/landing"
# jsons_path_data = f"{dbfs_path}/data/vr.json"
jsons_path_data = f"/Workspace/Users/sina.torabi@volvo.com/landing/vr_sample.json"
dfSource = spark.read.format("json").option("multiline", "true").load(jsons_path_data)
#display(dfSource)

code =  dg.DataAnalyzer.scriptDataGeneratorFromSchema(dfSource.schema)

# COMMAND ----------


# Code snippet generated with Databricks Labs Data Generator (`dbldatagen`) DataAnalyzer class
# Install with `pip install dbldatagen` or in notebook with `%pip install dbldatagen`
# See the following resources for more details:
#
#   Getting Started - [https://databrickslabs.github.io/dbldatagen/public_docs/APIDOCS.html]
#   Github project - [https://github.com/databrickslabs/dbldatagen]
#
import dbldatagen as dg
import pyspark.sql.types

# Column definitions are stubs only - modify to generate correct data  
#

generation_spec = (
    dg.DataGenerator(sparkSession=spark, 
                     name='synthetic_vr_data', 
                     rows=100000,
                     random=True,
                     )
    .withColumn('chassisNumber', 'string', template=r'\\w')
    .withColumn('chassisSeries', 'string', template=r'\\w')
    .withColumn('dataSets', 'struct<customerDisplayModel:struct<dataItems:struct<model:string>,dataProvider:string,lastModifiedDate:string,name:string>,displayUnit:struct<dataProvider:string,lastModifiedDate:string,name:string,subDataSets:struct<IC:array<struct<dataItems:struct<displayUnitType:string,partNumber:string,serialNumber:string>,lastModifiedDate:string,name:string>>,SEM:array<struct<dataItems:struct<displayUnitSubType:string,displayUnitType:string,partNumber:string,serialNumber:string>,lastModifiedDate:string,name:string>>>>,operationalStatus:struct<dataItems:struct<hasBeenOperational:string,operationalStatus:string,previousOperationalStatus:string,site:string,version:string,vonRefreshCounter:string>,dataProvider:string,lastModifiedDate:string,name:string>,variants:struct<dataProvider:string,lastModifiedDate:string,name:string,subDataSets:struct<0AX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,0BX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2CB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2CX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2DX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2EX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2FB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,2GB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3DX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3EX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3FX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3GX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3HX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,3IB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,4GB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,4GX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,4HX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,4KB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,5IB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,5JB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,5KA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,5LB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,5MX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6KX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6LX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6NA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6NB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6NX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,6OB:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,70X:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7LX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7MC:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7NA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7OX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7PX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,7QX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,8NX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,8PA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,8QA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,8RA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,8SA:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,9PX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,9QC:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,9RX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,9SX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,9TX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,AAX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,ABX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,BDX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,DHX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,ELX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,FNX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,H1B:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,H2E:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,I3A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,IRX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,J2A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,J2C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,J3A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,J4A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,JSX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,K4C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,K6B:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,K6C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,K6D:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,KTX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,KUX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,KWX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,L8X:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,LVX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,LWX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,LXX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,LZX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,M8A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,M8E:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,M9A:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,M9B:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,M9C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,NZX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,QCX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,RAX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,REX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,SFC:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,TEX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,TFX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,TGX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,THX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,UGX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,UJX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,ULX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,WLX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,WNX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,X1C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,XRX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,Y1C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,Y2B:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,Y2C:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,YOX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,YRX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,YSX:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>,Z5B:array<struct<dataItems:struct<variantDescription:string,variantFamilyId:string,variantId:string,variantSymbol:string>,name:string>>>>>', expr='null')
    .withColumn('lastModifiedDate', 'string', template=r'\\w')
    .withColumn('majorVersion', 'bigint', minValue=0, maxValue=1000000)
    .withColumn('masterDataProvider', 'string', template=r'\\w')
    .withColumn('minorVersion', 'bigint', minValue=0, maxValue=1000000)
    .withColumn('vehiclePlatformId', 'string', template=r'\\w')
    .withColumn('vehicleVersion', 'bigint', minValue=0, maxValue=1000000)
    .withColumn('vin', 'string', template=r'\\w')
    )

# COMMAND ----------

dfTestData = generation_spec.build()
display(dfTestData,10)
